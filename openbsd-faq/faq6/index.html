
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.3">
    
    
      
        <title>网络配置 - OpenBSD 中文结社</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.edf004c2.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
          
          
          <meta name="theme-color" content="#ff6e42">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-orange" data-md-color-accent="orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#openbsd-faq---网络" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="OpenBSD 中文结社" class="md-header__button md-logo" aria-label="OpenBSD 中文结社" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OpenBSD 中文结社
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              网络配置
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/openbsd-zh-association/docs-openbsd-zh/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OpenBSD 中文结社" class="md-nav__button md-logo" aria-label="OpenBSD 中文结社" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    OpenBSD 中文结社
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/openbsd-zh-association/docs-openbsd-zh/" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        主页
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          OpenBSD FAQ
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="OpenBSD FAQ" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          OpenBSD FAQ
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq1/" class="md-nav__link">
        OpenBSD 简介
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq4/" class="md-nav__link">
        安装指南
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq10/" class="md-nav__link">
        系统管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq14/" class="md-nav__link">
        配置磁盘
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq15/" class="md-nav__link">
        软件包管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq5/" class="md-nav__link">
        从源码构建系统
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          网络配置
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        网络配置
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#网络配置" class="md-nav__link">
    网络配置
  </a>
  
    <nav class="md-nav" aria-label="网络配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#识别和设置网络接口" class="md-nav__link">
    识别和设置网络接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#默认主机名和网关" class="md-nav__link">
    默认主机名和网关
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-解析" class="md-nav__link">
    DNS 解析
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#激活更改" class="md-nav__link">
    激活更改
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#检查路由" class="md-nav__link">
    检查路由
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#在接口上设置别名" class="md-nav__link">
    在接口上设置别名
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#动态主机设置协议" class="md-nav__link">
    动态主机设置协议
  </a>
  
    <nav class="md-nav" aria-label="动态主机设置协议">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhcp-客户端" class="md-nav__link">
    DHCP 客户端
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhcp-服务器" class="md-nav__link">
    DHCP 服务器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pxe-启动i386amd64" class="md-nav__link">
    PXE 启动（i386，amd64）
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#无线网络" class="md-nav__link">
    无线网络
  </a>
  
    <nav class="md-nav" aria-label="无线网络">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#配置无线适配器" class="md-nav__link">
    配置无线适配器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#中继无线适配器" class="md-nav__link">
    中继无线适配器
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#搭建网桥" class="md-nav__link">
    搭建网桥
  </a>
  
    <nav class="md-nav" aria-label="搭建网桥">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#作为-dhcp-服务器的网桥" class="md-nav__link">
    作为 DHCP 服务器的网桥
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#在网桥上过滤" class="md-nav__link">
    在网桥上过滤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#桥接技巧" class="md-nav__link">
    桥接技巧
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#等价多路径路由" class="md-nav__link">
    等价多路径路由
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#使用-nfs" class="md-nav__link">
    使用 NFS
  </a>
  
    <nav class="md-nav" aria-label="使用 NFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#搭建一个-nfs-服务器" class="md-nav__link">
    搭建一个 NFS 服务器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#挂载-nfs-文件系统" class="md-nav__link">
    挂载 NFS 文件系统
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#检查-nfs-上的统计信息" class="md-nav__link">
    检查 NFS 上的统计信息
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq7/" class="md-nav__link">
        键盘和显示控制
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq11/" class="md-nav__link">
        X 窗口系统
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq13/" class="md-nav__link">
        多媒体
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq16/" class="md-nav__link">
        虚拟化
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq17/" class="md-nav__link">
        虚拟专用网络
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          其他
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="其他" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          其他
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/upgrade70/" class="md-nav__link">
        升级向导
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/report/" class="md-nav__link">
        报告 BUG
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/current/" class="md-nav__link">
        跟随 -current 和使用快照
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../others/mail/" class="md-nav__link">
        邮件列表
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          贡献者指南
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="贡献者指南" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          贡献者指南
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contribution/contributing/" class="md-nav__link">
        总述
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contribution/translation_rules/" class="md-nav__link">
        翻译规范
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          关于
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="关于" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          关于
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/international-about/" class="md-nav__link">
        International About（英文简介）
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../about/terminology/" class="md-nav__link">
        术语表
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#网络配置" class="md-nav__link">
    网络配置
  </a>
  
    <nav class="md-nav" aria-label="网络配置">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#识别和设置网络接口" class="md-nav__link">
    识别和设置网络接口
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#默认主机名和网关" class="md-nav__link">
    默认主机名和网关
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-解析" class="md-nav__link">
    DNS 解析
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#激活更改" class="md-nav__link">
    激活更改
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#检查路由" class="md-nav__link">
    检查路由
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#在接口上设置别名" class="md-nav__link">
    在接口上设置别名
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#动态主机设置协议" class="md-nav__link">
    动态主机设置协议
  </a>
  
    <nav class="md-nav" aria-label="动态主机设置协议">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dhcp-客户端" class="md-nav__link">
    DHCP 客户端
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dhcp-服务器" class="md-nav__link">
    DHCP 服务器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pxe-启动i386amd64" class="md-nav__link">
    PXE 启动（i386，amd64）
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#无线网络" class="md-nav__link">
    无线网络
  </a>
  
    <nav class="md-nav" aria-label="无线网络">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#配置无线适配器" class="md-nav__link">
    配置无线适配器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#中继无线适配器" class="md-nav__link">
    中继无线适配器
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#搭建网桥" class="md-nav__link">
    搭建网桥
  </a>
  
    <nav class="md-nav" aria-label="搭建网桥">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#作为-dhcp-服务器的网桥" class="md-nav__link">
    作为 DHCP 服务器的网桥
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#在网桥上过滤" class="md-nav__link">
    在网桥上过滤
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#桥接技巧" class="md-nav__link">
    桥接技巧
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#等价多路径路由" class="md-nav__link">
    等价多路径路由
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#使用-nfs" class="md-nav__link">
    使用 NFS
  </a>
  
    <nav class="md-nav" aria-label="使用 NFS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#搭建一个-nfs-服务器" class="md-nav__link">
    搭建一个 NFS 服务器
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#挂载-nfs-文件系统" class="md-nav__link">
    挂载 NFS 文件系统
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#检查-nfs-上的统计信息" class="md-nav__link">
    检查 NFS 上的统计信息
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/openbsd-zh-association/docs-openbsd-zh/edit/master/docs/openbsd-faq/faq6.md" title="编辑此页" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="openbsd-faq---网络">OpenBSD FAQ - 网络<a class="headerlink" href="#openbsd-faq---网络" title="Permanent link">&para;</a></h1>
<h2 id="网络配置">网络配置<a class="headerlink" href="#网络配置" title="Permanent link">&para;</a></h2>
<p>OpenBSD 中的网络配置是通过 <code>/etc</code> 中的文本文件完成的。这些设置通常最初是在<a href="https://www.openbsd.org/faq/faq4.html">系统安装过程</a>中配置的。</p>
<h3 id="识别和设置网络接口">识别和设置网络接口<a class="headerlink" href="#识别和设置网络接口" title="Permanent link">&para;</a></h3>
<p>接口由网卡的类型命名，而不是连接的类型。例如，以下是 Intel 快速以太网网卡的 <a href="https://man.openbsd.org/dmesg">dmesg(8)</a> 片段：</p>
<pre><code>fxp0 at pci0 dev 10 function 0 &quot;Intel 82557&quot; rev 0x0c: irq 5, address 00:02:b3:2b:10:f7
inphy0 at fxp0 phy 1: i82555 10/100 media interface, rev. 4
</code></pre>
<p>此设备使用 <a href="https://man.openbsd.org/fxp">fxp(4)</a> 驱动程序并在此处分配编号 0。</p>
<p><a href="https://man.openbsd.org/ifconfig">ifconfig(8)</a> 实用程序将显示系统上已识别的网络接口。</p>
<pre><code>$ ifconfig
lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 33200
        index 3 priority 0 llprio 3
        groups: lo
        inet 127.0.0.1 netmask 0xff000000
fxp0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        lladdr 00:02:b3:2b:10:f7
        index 1 priority 0 llprio 3
        media: Ethernet autoselect (100baseTX full-duplex)
        status: active
        inet 10.0.0.38 netmask 0xffffff00 broadcast 10.0.0.255
enc0: flags=0&lt;&gt;
        index 2 priority 0 llprio 3
        groups: enc
        status: active
pflog0: flags=141&lt;UP,RUNNING,PROMISC&gt; mtu 33200
        index 4 priority 0 llprio 3
        groups: pflog
</code></pre>
<p>此示例仅显示一个物理以太网接口：<code>fxp0</code>。该接口配置了 IP，因此值为 <code>inet 10.0.0.38 netmask 0xffffff00 broadcast 10.0.0.255</code>。它也配置了 <code>UP</code> 和 <code>RUNNING</code> 标志。</p>
<p><a href="https://man.openbsd.org/netstart">netstart(8)</a> 脚本在引导时使用 <a href="https://man.openbsd.org/hostname.if">hostname.if(5)</a> 文件配置网络接口，其中 “if” 被每个接口的全名替换。上面的示例将使用文件 <code>/etc/hostname.fxp0</code>，其中包含以下选项：</p>
<pre><code>inet 10.0.0.38 255.255.255.0
</code></pre>
<p>这个 <code>hostname.fxp0</code> 文件也有一个交互式等效文件：</p>
<pre><code># ifconfig fxp0 10.0.0.38 255.255.255.0
</code></pre>
<p>默认情况下启用其他几个接口。这些虚拟接口用于提供各种功能。以下手册页描述了它们：</p>
<ul>
<li><a href="https://man.openbsd.org/enc">enc(4)</a> - 封装接口</li>
<li><a href="https://man.openbsd.org/lo">lo(4)</a> - 环回接口</li>
<li><a href="https://man.openbsd.org/pflog">pflog(4)</a> - 数据包过滤器日志记录接口</li>
</ul>
<p>你可以使用 <a href="https://man.openbsd.org/ifconfig">ifconfig(8)</a> 的 <code>create</code> 子命令添加其他虚拟接口。</p>
<h3 id="默认主机名和网关">默认主机名和网关<a class="headerlink" href="#默认主机名和网关" title="Permanent link">&para;</a></h3>
<p><code>/etc/myname</code> 和 <code>/etc/mygate</code> 文件由 <a href="https://man.openbsd.org/netstart">netstart(8)</a> 脚本读取。这两个文件由一行字组成，分别指定系统的完全限定域名（fully qualified domain name）和网关主机的地址。<code>/etc/mygate</code> 文件不需要在所有系统上都存在。有关更多详细信息，请参阅 <a href="https://man.openbsd.org/myname">myname(5)</a>。</p>
<h3 id="dns-解析">DNS 解析<a class="headerlink" href="#dns-解析" title="Permanent link">&para;</a></h3>
<p>DNS 解析由 <a href="https://man.openbsd.org/resolv.conf">resolv.conf(5)</a> 文件控制，该文件由 <a href="https://man.openbsd.org/resolvd">resolvd(8)</a> 管理。</p>
<pre><code>$ cat /etc/resolv.conf
search example.com
nameserver 125.2.3.4
nameserver 125.2.3.5
lookup file bind
</code></pre>
<p>这里默认的域名是 <code>example.com</code>，会有两个名称服务器（<code>125.2.3.4</code> 和 <code>125.2.3.5</code>），并且在名称服务器之前会查询 <a href="https://man.openbsd.org/hosts">hosts(5)</a> 文件。</p>
<h3 id="激活更改">激活更改<a class="headerlink" href="#激活更改" title="Permanent link">&para;</a></h3>
<p>从这里，重新启动或运行 <a href="https://man.openbsd.org/netstart">netstart(8)</a> 脚本：</p>
<pre><code># sh /etc/netstart
</code></pre>
<p>如果已经配置了接口，则在运行此脚本时可能会产生一些警告。使用 <a href="https://man.openbsd.org/ifconfig">ifconfig(8)</a> 确保接口设置正确。</p>
<p>尽管可以在正在运行中的 OpenBSD 系统上完全重新配置网络，但建议在任何重大更改后重新启动。</p>
<h3 id="检查路由">检查路由<a class="headerlink" href="#检查路由" title="Permanent link">&para;</a></h3>
<p>可以通过 <a href="https://man.openbsd.org/netstat">netstat(1)</a> 或 <a href="https://man.openbsd.org/route">route(8)</a> 检查路由。</p>
<pre><code>$ netstat -rn
Routing tables

Internet:
Destination        Gateway            Flags     Refs     Use    Mtu  Prio Iface
default            10.0.0.1           UGS         4       16      -    12 fxp0
224/4              127.0.0.1          URS         0        0  32768     8 lo0
127/8              127.0.0.1          UGRS        0        0  32768     8 lo0
127.0.0.1          127.0.0.1          UH          2       15  32768     1 lo0
10.0.0/24          link#1             UC          1        4      -     4 fxp0
10.0.0.1           aa:0:4:0:81:d      UHL         1       11      -     1 fxp0
10.0.0.38          127.0.0.1          UGHS        0        0      -     1 lo0

$ route show
Routing tables

Internet:
Destination        Gateway            Flags     Refs     Use    Mtu  Prio Iface
default            10.0.0.1           UGS         4       16      -    12 fxp0
base-address.mcast localhost          URS         0        0  32768     8 lo0
loopback           localhost          UGRS        0        0  32768     8 lo0
localhost          localhost          UH          2       15  32768     1 lo0
10.0.0/24          link#1             UC          1        4      -     4 fxp0
10.0.0.1           aa:0:4:0:81:d      UHL         1       11      -     1 fxp0
10.0.0.38          localhost          UGHS        0        0      -     1 lo0
</code></pre>
<h3 id="在接口上设置别名">在接口上设置别名<a class="headerlink" href="#在接口上设置别名" title="Permanent link">&para;</a></h3>
<p>要在接口上设置 IP 别名，只需编辑其 <a href="https://man.openbsd.org/hostname.if">hostname.if(5)</a> 文件。</p>
<p>在本例中，两个别名被添加到接口 <code>dc0</code>，它被配置为 <code>192.168.0.2</code>，网络掩码为 <code>255.255.255.0</code>。</p>
<pre><code>$ cat /etc/hostname.dc0
inet 192.168.0.2 255.255.255.0
inet alias 192.168.0.3 255.255.255.255
inet alias 192.168.0.4 255.255.255.255
</code></pre>
<p>创建此文件后，<a href="https://www.openbsd.org/faq/faq6.html#Setup.activate">运行 netstart</a> 或重新启动。要查看所有别名，请使用 <code>ifconfig -A</code>。</p>
<h2 id="动态主机设置协议">动态主机设置协议<a class="headerlink" href="#动态主机设置协议" title="Permanent link">&para;</a></h2>
<p>动态主机设置协议 (DHCP) 是一种自动配置网络接口的方法。OpenBSD 可以是配置其他机器的 DHCP 服务器，也可以是由 DHCP 服务器配置的 DHCP 客户端。</p>
<h3 id="dhcp-客户端">DHCP 客户端<a class="headerlink" href="#dhcp-客户端" title="Permanent link">&para;</a></h3>
<p>要使用 <a href="https://man.openbsd.org/dhcpleased">dhcpleased(8)</a>，请编辑网络接口的 <a href="https://man.openbsd.org/hostname.if">hostname.if(5)</a> 文件。<a href="https://www.openbsd.org/faq/faq6.html#Wireless">无线网络</a>部分解释了如何设置无线接口。对于以太网接口，一行就足够了：</p>
<pre><code>inet autoconf
</code></pre>
<p>OpenBSD 将在启动时从 DHCP 服务器收集其 IP 地址、默认网关和 DNS 服务器。其他选项可以在 <a href="https://man.openbsd.org/dhcpleased.conf">dhcpleased.conf(5)</a> 中指定。</p>
<p>要从命令行通过 DHCP 获取 IP，请运行：</p>
<pre><code># ifconfig xl0 inet autoconf
</code></pre>
<p>将 <code>xl0</code> 替换为接口名称。</p>
<h3 id="dhcp-服务器">DHCP 服务器<a class="headerlink" href="#dhcp-服务器" title="Permanent link">&para;</a></h3>
<p>要使用 OpenBSD 作为 DHCP 服务器，请在启动时启用 <a href="https://man.openbsd.org/dhcpd">dhcpd(8)</a> 守护进程：</p>
<pre><code># rcctl enable dhcpd
</code></pre>
<p>下次启动时，dhcpd 将运行并附加到 <a href="https://man.openbsd.org/dhcpd.conf">dhcpd.conf(5)</a> 中具有有效配置的所有 NIC。可以通过明确地命名来指定单个接口：</p>
<pre><code># rcctl set dhcpd flags em1 em2
</code></pre>
<p><code>/etc/dhcpd.conf</code> 示例文件可能如下所示：</p>
<pre><code># Home
subnet 192.168.1.0 netmask 255.255.255.0 {
    option domain-name-servers 192.168.1.2;
    option routers 192.168.1.1;
    range 192.168.1.3 192.168.1.50;
}

# Guests
subnet 172.16.0.0 netmask 255.255.255.0 {
    option domain-name-servers 1.2.3.4, 5.6.7.8;
    option routers 172.16.0.1;
    range 172.16.0.2 172.16.0.254;
}
</code></pre>
<p>本示例中有两个子网：家庭网络和访客网络。客户端将自动获得一个 IP 地址，并指向配置文件各自部分中指定的网关和 DNS 服务器。有关更多选项，请参阅 <a href="https://man.openbsd.org/dhcp-options">dhcp-options(5)</a>。</p>
<h3 id="pxe-启动i386amd64">PXE 启动（i386，amd64）<a class="headerlink" href="#pxe-启动i386amd64" title="Permanent link">&para;</a></h3>
<p>预引导执行环境 (PXE) 是仅使用网络引导系统的标准方法。客户端的具有 PXE 功能的 NIC 在<a href="https://www.openbsd.org/faq/faq14.html#BootAmd64">启动过程</a>开始时广播 DHCP 请求，并且不仅接收基本的 IP/DNS 信息，还提供一个用于启动的文件。在 OpenBSD 上，这个文件被称为 <a href="https://man.openbsd.org/pxeboot">pxeboot(8)</a>，通常由 <a href="https://man.openbsd.org/tftpd">tftpd(8)</a> 提供服务。</p>
<h2 id="无线网络">无线网络<a class="headerlink" href="#无线网络" title="Permanent link">&para;</a></h2>
<p>OpenBSD 支持<a href="https://man.openbsd.org/?query=wireless&amp;apropos=1">多种无线芯片组</a>。更多支持的设备可以在 <a href="https://man.openbsd.org/usb">usb(4)</a> 和 <a href="https://man.openbsd.org/pci">pci(4)</a> 中找到。驱动程序手册页中描述了它们支持的确切范围。</p>
<p>以下网卡支持基于主机的接入点 (Host-based Access Point, HostAP) 模式，允许它们用作<a href="https://www.openbsd.org/faq/pf/example1.html">无线接入点</a>：</p>
<ul>
<li><a href="https://man.openbsd.org/acx">acx(4)</a> - TI ACX100/ACX111</li>
<li><a href="https://man.openbsd.org/ath">ath(4)</a> - Atheros 802.11a/b/g</li>
<li><a href="https://man.openbsd.org/athn">athn(4)</a> - Atheros 802.11/a/g/n devices</li>
<li><a href="https://man.openbsd.org/bwfm">bwfm(4)</a> - Broadcom 和 Cypress IEEE 802.11a/ac/b/g/n 无线网络设备</li>
<li><a href="https://man.openbsd.org/pgt">pgt(4)</a> - Conexant/Intersil Prism GT Full-MAC 802.11a/b/g</li>
<li><a href="https://man.openbsd.org/ral">ral(4)</a> 和 <a href="https://man.openbsd.org/ural">ural(4)</a> - Ralink Technology RT25x0 802.11a/b/g</li>
<li><a href="https://man.openbsd.org/rtw">rtw(4)</a> - Realtek 8180 802.11b</li>
<li><a href="https://man.openbsd.org/rum">rum(4)</a> - Ralink Technology RT2501USB</li>
<li><a href="https://man.openbsd.org/wi">wi(4)</a> - Prism2/2.5/3</li>
</ul>
<p>ifconfig(8) 的 <code>media</code> 子命令可用于显示网络接口的媒体功能。对于无线设备，它显示支持的 802.11a/b/g/n 媒体模式和支持的操作模式（<code>hostap</code>、<code>ibss</code>、<code>monitor</code>）。 例如，要查看接口 <code>ath0</code> 的媒体功能，请运行：</p>
<pre><code>$ ifconfig ath0 media
</code></pre>
<p>为了使用某些无线网卡，可能需要通过 <a href="https://man.openbsd.org/fw_update">fw_update(1)</a> 获取的固件文件。一些制造商拒绝允许<a href="https://www.openbsd.org/faq/faq1.html#ReallyFree">自由</a>分发他们的固件，因此它不能包含在 OpenBSD 中。</p>
<p>另一个需要考虑的选择：为基于 OpenBSD 的防火墙使用传统的 NIC 和外部桥接无线接入点。</p>
<h3 id="配置无线适配器">配置无线适配器<a class="headerlink" href="#配置无线适配器" title="Permanent link">&para;</a></h3>
<p>基于受支持芯片的适配器可以像任何其他网络接口一样使用。要将 OpenBSD 系统连接到现有的无线网络，请使用 <a href="https://man.openbsd.org/ifconfig">ifconfig(8)</a> 实用程序。</p>
<p>无线客户端的 <a href="https://man.openbsd.org/hostname.if">hostname.if(5)</a> 文件示例可能是：</p>
<pre><code>nwid puffyuberalles wpakey passwordhere
inet autoconf
</code></pre>
<p>或者，对于多个接入点：</p>
<pre><code>join home-net wpakey passwordhere
join work-net wpakey passwordhere
join cafe-wifi
inet autoconf
</code></pre>
<p>请注意 <code>inet autoconf</code> 应该放置在其他配置行之后，因为在配置完成之前网络适配器将无法发送 DHCP 请求。</p>
<h3 id="中继无线适配器">中继无线适配器<a class="headerlink" href="#中继无线适配器" title="Permanent link">&para;</a></h3>
<p>中继（Trunks）是由一个或多个网络接口组成的虚拟接口。在本节中，我们的示例将是带有有线 <a href="https://man.openbsd.org/bge">bge0</a> 接口和无线 <a href="https://man.openbsd.org/iwn">iwn0</a> 接口的笔记本电脑。我们将使用它们构建一个 <a href="https://man.openbsd.org/trunk">trunk(4)</a> 接口。有线和无线接口必须连接到同一个二层网络。</p>
<p>为此，我们首先激活两个物理端口，然后将它们分配给 <code>trunk0</code>。</p>
<pre><code># echo up &gt; /etc/hostname.bge0
</code></pre>
<p>然而，无线接口需要更多的配置。它需要连接到我们受 WPA 保护的无线网络：</p>
<pre><code>$ cat /etc/hostname.iwn0
nwid puffynet wpakey mysecretkey
up
</code></pre>
<p>现在，我们的中继接口定义如下：</p>
<pre><code>$ cat /etc/hostname.trunk0
trunkproto failover trunkport bge0
trunkport iwn0
inet autoconf
</code></pre>
<p>中继设置为故障转移模式，因此可以使用任一接口。如果两者都可用，它将首选 <code>bge0</code> 端口，因为这是添加到中继设备的第一个端口。</p>
<h2 id="搭建网桥">搭建网桥<a class="headerlink" href="#搭建网桥" title="Permanent link">&para;</a></h2>
<p><a href="https://man.openbsd.org/bridge">bridge(4)</a> 是两个或多个独立网络之间的链接。与路由器不同，数据包透明地通过网桥：两个网段对任一侧的节点都显示为一个。网桥只会转发必须从一个网段传递到另一个网段的数据包，因此网桥中的接口可能有也可能没有自己的 IP 地址。如果是这样，该接口实际上具有两种操作模式：一种作为网桥的一部分，另一种作为独立的 NIC。如果两个接口都没有 IP 地址，则网桥将传递网络数据，但无法进行外部维护（这可以是一个功能）。</p>
<h3 id="作为-dhcp-服务器的网桥">作为 DHCP 服务器的网桥<a class="headerlink" href="#作为-dhcp-服务器的网桥" title="Permanent link">&para;</a></h3>
<p>假设我们有一个系统，它有四个 <a href="https://man.openbsd.org/vr">vr(4)</a> 接口，<code>vr0</code> 到 <code>vr3</code>。 我们希望将 <code>vr1</code>、<code>vr2</code> 和 <code>vr3</code> 桥接在一起，而将 <code>vr0</code> 留给上行链路。 我们还希望通过桥接接口上的 DHCP 提供 IP 地址。作为 DHCP 服务器和上行链路路由器，该盒子需要在桥接网络上有一个 IP 地址。</p>
<p>无法将 IP 地址直接分配给网桥接口。IP 地址应该添加到成员接口之一，但我们不能使用物理接口，因为链接可能会关闭，在这种情况下，地址将无法访问。 幸运的是，有可用于此目的的 <a href="https://man.openbsd.org/vether">vether(4)</a>（虚拟以太网）驱动程序。我们将它添加到网桥，为其分配 IP 地址并使 dhcpd(8) 在那里监听。</p>
<ul>
<li>本节不再对 <a href="https://www.openbsd.org/faq/faq6.html#DHCPserver">DHCP 服务器配置</a>进行描述，但这里使用的寻址方案是相同的。</li>
<li>这也将是桥接网络的上行链路路由器，因此我们将使用 IP 地址 <code>192.168.1.1</code> 来匹配 DHCP 服务器配置。</li>
<li>我们不会在这里介绍上行链路、路由或防火墙配置。</li>
</ul>
<p>首先，将 <code>vr1</code>、<code>vr2</code> 和 <code>vr3</code> 接口标记为 <code>up</code>：</p>
<pre><code># echo up &gt; /etc/hostname.vr1
# echo up &gt; /etc/hostname.vr2
# echo up &gt; /etc/hostname.vr3
</code></pre>
<p>然后创建 <code>vether0</code> 配置：</p>
<pre><code># echo 'inet 192.168.1.1 255.255.255.0 192.168.1.255' &gt; /etc/hostname.vether0
</code></pre>
<p>配置桥接接口以包含上述所有接口：</p>
<pre><code>$ cat /etc/hostname.bridge0
add vether0
add vr1
add vr2
add vr3
up
</code></pre>
<p>最后我们让 DHCP 守护进程监听 vether0 接口：</p>
<pre><code># rcctl set dhcpd flags vether0
</code></pre>
<p>最后，重新启动系统。</p>
<h3 id="在网桥上过滤">在网桥上过滤<a class="headerlink" href="#在网桥上过滤" title="Permanent link">&para;</a></h3>
<p><a href="https://www.openbsd.org/faq/pf/index.html">PF</a> 可用于限制通过网桥的流量。请记住，根据网桥的性质，相同的数据流经两个接口，因此只需要在一个接口上进行过滤。</p>
<h3 id="桥接技巧">桥接技巧<a class="headerlink" href="#桥接技巧" title="Permanent link">&para;</a></h3>
<ul>
<li>通过使用 <a href="https://man.openbsd.org/ifconfig">ifconfig(8)</a> 或 <a href="https://man.openbsd.org/hostname.if">hostname.bridge0</a> 中的 <code>blocknonip</code> 选项，可以防止非 IP 流量（例如 IPX 或 NETBEUI）绕过过滤器。 这在某些情况下可能很重要，但请注意网桥适用于所有类型的流量，而不仅仅是 IP。</li>
<li>桥接要求 NIC 处于混杂模式（promiscuous mode）。它们侦听<strong>所有</strong>网络流量，而不仅仅是针对接口的流量。这会给处理器和总线带来比预期更高的负载。</li>
</ul>
<h2 id="等价多路径路由">等价多路径路由<a class="headerlink" href="#等价多路径路由" title="Permanent link">&para;</a></h2>
<p>等价多路径路由（Equal-Cost Multipath Routing）是指在同一网络的路由表中有多条路由，如默认路由 0.0.0.0/0。 当内核进行路由查找以确定将发往该网络的数据包发送到何处时，它可以从任何等价路由中进行选择。在大多数情况下，多路径路由用于提供冗余上行链路连接，例如到 Internet 的冗余连接。</p>
<p><a href="https://man.openbsd.org/route">route(8)</a> 命令用于在路由表中添加/更改/删除路由。添加多路径路由时使用 <code>-mpath</code> 参数。</p>
<pre><code># route add -mpath default 10.130.128.1
# route add -mpath default 10.132.0.1
</code></pre>
<p>验证路由：</p>
<pre><code># netstat -rnf inet | grep default
default     10.130.128.1      UGS       2      134      -     fxp1
default     10.132.0.1        UGS       0      172      -     fxp2
</code></pre>
<p>在这个例子中，我们可以看到一个默认路由指向 <code>10.130.128.1</code>，可以通过 <code>fxp1</code> 接口访问，另一个指向 <code>10.132.0.1</code>，可以通过 <code>fxp2</code> 访问。</p>
<p>由于 <a href="https://man.openbsd.org/mygate">mygate(5)</a> 文件尚不支持多路径默认路由，因此应将上述命令添加到 fxp1 和 fxp2 接口的 <a href="https://man.openbsd.org/hostname.if">hostname.if(5)</a> 文件的底部。然后应该删除 <code>/etc/mygate</code> 文件。</p>
<pre><code>$ tail -1 /etc/hostname.fxp1
!route add -mpath default 10.130.128.1
$ tail -1 /etc/hostname.fxp2
!route add -mpath default 10.132.0.1
</code></pre>
<p>最后，不要忘记通过启用适当的 <a href="https://man.openbsd.org/sysctl.8">sysctl(8)</a> 变量来激活多路径路由的使用。</p>
<pre><code># sysctl net.inet.ip.multipath=1
# sysctl net.inet6.ip6.multipath=1
</code></pre>
<p>请务必编辑 <a href="https://man.openbsd.org/sysctl.conf">sysctl.conf(5)</a> 以使更改永久生效。</p>
<p>现在尝试跟踪路由到不同的目的地。内核将负载平衡每条多路径路由上的流量。</p>
<pre><code># traceroute -n 154.11.0.4
traceroute to 154.11.0.4 (154.11.0.4), 64 hops max, 60 byte packets
 1  10.130.128.1  19.337 ms  18.194 ms  18.849 ms
 2  154.11.95.170  17.642 ms  18.176 ms  17.731 ms
 3  154.11.5.33  110.486 ms  19.478 ms  100.949 ms
 4  154.11.0.4  32.772 ms  33.534 ms  32.835 ms

# traceroute -n 154.11.0.5
traceroute to 154.11.0.5 (154.11.0.5), 64 hops max, 60 byte packets
 1  10.132.0.1  14.175 ms  14.503 ms  14.58 ms
 2  154.11.95.38  13.664 ms  13.962 ms  13.445 ms
 3  208.38.16.151  13.964 ms  13.347 ms  13.788 ms
 4  154.11.0.5  30.177 ms  30.95 ms  30.593 ms
</code></pre>
<p>有关如何选择路由的更多信息，请参阅 <a href="https://www.ietf.org/rfc/rfc2992.txt">RFC2992</a>，“等价多路径算法的分析（Analysis of an Equal-Cost Multi-Path Algorithm）”。</p>
<p>值得注意的是，如果多路径路由使用的接口出现故障（即丢失载波（carrier）），内核仍将尝试使用指向该接口的路由转发数据包。这种流量当然会被黑洞化，最终无处可去。强烈建议使用 <a href="https://man.openbsd.org/ifstated">ifstated(8)</a> 来检查不可用的接口并相应地调整路由表。</p>
<h2 id="使用-nfs">使用 NFS<a class="headerlink" href="#使用-nfs" title="Permanent link">&para;</a></h2>
<p>网络文件系统 NFS 用于通过网络共享文件系统。</p>
<p>本节将介绍简单 NFS 设置的步骤。该示例详细介绍了 LAN 上的服务器，客户端访问 LAN 上的 NFS。该节不包括保护 NFS。</p>
<h3 id="搭建一个-nfs-服务器">搭建一个 NFS 服务器<a class="headerlink" href="#搭建一个-nfs-服务器" title="Permanent link">&para;</a></h3>
<p>首先，在服务器上启用 <a href="https://man.openbsd.org/portmap">portmap(8)</a>、<a href="https://man.openbsd.org/mountd">mountd(8)</a> 和 <a href="https://man.openbsd.org/nfsd">nfsd(8)</a> 服务：</p>
<pre><code># rcctl enable portmap mountd nfsd
</code></pre>
<p>然后配置将可用的文件系统列表。</p>
<p>在本例中，我们有一个 IP 地址为 <code>10.0.0.1</code> 的服务器。此服务器将仅向其自己子网内的客户端提供 NFS 服务。这是在下列 exports(5) 文件中配置的：</p>
<pre><code>$ cat /etc/exports
/docs -alldirs -ro -network=10.0.0 -mask=255.255.255.0
</code></pre>
<p>本地文件系统 <code>/docs</code> 将通过 NFS 提供。<code>-alldirs</code> 选项指定客户端将能够在 <code>/docs</code> 以及 <code>/docs</code> 本身下的任何位置挂载。<code>-ro</code> 选项指定客户端将仅被授予只读访问权限。最后两个参数指定只有使用 <code>255.255.255.0</code> 网络掩码的 <code>10.0.0.0</code> 网络中的客户端才能被授权挂载此文件系统。</p>
<p>现在启动服务器相关的服务：</p>
<pre><code># rcctl start portmap mountd nfsd
</code></pre>
<p>如果在 NFS 已经运行时对 <code>/etc/exports</code> 进行了更改，则必须重启 <code>mountd</code> 重新载入配置。</p>
<pre><code># rcctl reload mountd
</code></pre>
<h3 id="挂载-nfs-文件系统">挂载 NFS 文件系统<a class="headerlink" href="#挂载-nfs-文件系统" title="Permanent link">&para;</a></h3>
<p>NFS 文件系统应该通过 <a href="https://man.openbsd.org/mount_nfs">mount(8)</a>，或者更具体地说，<a href="https://man.openbsd.org/mount_nfs">mount_nfs(8)</a> 挂载。</p>
<p>要将主机 <code>10.0.0.1</code> 上的 <code>/docs</code> 文件系统挂载到本地文件系统 <code>/mnt</code>，请运行：</p>
<pre><code># mount -t nfs 10.0.0.1:/docs /mnt
</code></pre>
<p>要在引导时挂载该文件系统，请在 <a href="https://man.openbsd.org/fstab">fstab(5)</a> 中添加一行，如下所示：</p>
<pre><code># echo '10.0.0.1:/docs /mnt nfs ro,nodev,nosuid 0 0' &gt;&gt; /etc/fstab
</code></pre>
<p>在这一行的末尾使用 <code>0 0</code> 很重要，这样计算机就不会在启动时尝试 <a href="https://man.openbsd.org/fsck">fsck(8)</a> NFS 文件系统。</p>
<p>当以 root 用户访问 NFS 挂载时，服务器会自动将 root 的访问权限映射到用户名 <code>nobody</code> 和组 <code>nobody</code>。在考虑文件权限时了解这一点很重要。例如，获取具有以下权限的文件：</p>
<pre><code>-rw-------    1 root     wheel           0 Dec 31 03:00 _daily.B20143
</code></pre>
<p>如果此文件位于 NFS 共享上并且 root 用户尝试从 NFS 客户端访问此文件，则访问将被拒绝。</p>
<p>root 映射到的用户和组可以通过 NFS 服务器上的 <a href="https://man.openbsd.org/exports">exports(5)</a> 文件进行配置。</p>
<h3 id="检查-nfs-上的统计信息">检查 NFS 上的统计信息<a class="headerlink" href="#检查-nfs-上的统计信息" title="Permanent link">&para;</a></h3>
<p>要确保 NFS 正常运行，需要检查的一件事是所有守护程序都已正确注册到 RPC。 为此，请使用 <a href="https://man.openbsd.org/rpcinfo">rpcinfo(8)</a>。</p>
<pre><code>$ rpcinfo -p 10.0.0.1
   program vers proto   port
    100000    2   tcp    111  portmapper
    100000    2   udp    111  portmapper
    100005    1   udp    633  mountd
    100005    3   udp    633  mountd
    100005    1   tcp    916  mountd
    100005    3   tcp    916  mountd
    100003    2   udp   2049  nfs
    100003    3   udp   2049  nfs
    100003    2   tcp   2049  nfs
    100003    3   tcp   2049  nfs
</code></pre>
<p>一些实用程序允许管理员查看 NFS 发生的情况，例如 <a href="https://man.openbsd.org/showmount">showmount(8)</a> 和 <a href="https://man.openbsd.org/nfsstat">nfsstat(1)</a>。</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="页脚">
      
        
        <a href="../faq5/" class="md-footer__link md-footer__link--prev" aria-label="上一页: 从源码构建系统" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              从源码构建系统
            </div>
          </div>
        </a>
      
      
        
        <a href="../faq7/" class="md-footer__link md-footer__link--next" aria-label="下一页: 键盘和显示控制" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              键盘和显示控制
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © 2021–2022 OpenBSD 中文结社贡献者
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "search": "../../assets/javascripts/workers/search.0bbba5b5.min.js"}</script>
    
    
      <script src="../../assets/javascripts/bundle.e1a181d9.min.js"></script>
      
    
  </body>
</html>